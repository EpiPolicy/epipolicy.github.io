{"version":3,"sources":["view/components/sidebar.js","view/components/pagedisplay.js","view/app.js","model/index.js","reportWebVitals.js","index.js"],"names":["Sidebar","props","model","state","loginBox","this","loginInfo","className","onClick","logOut","loginError","autoFocus","type","onKeyDown","event","setState","key","checkLoginPassword","target","value","password","logIn","catch","err","page","window","location","hash","slice","children","name","map","p","renderMenuItem","protected","active","goTo","url","id","MathJax","typeset","pages","renderLoginBox","document","title","history","pushState","checkPagesActivation","React","Component","observer","PageDisplay","activePage","dangerouslySetInnerHTML","__html","activePageContent","setTimeout","App","pages_config","makeObservable","observable","action","computed","onpopstate","e","path","checkPagesFn","checkFn","loadActivePage","text","replace","match","p1","errMsg","urlRoot","axios","get","then","response","data","CryptoJS","AES","decrypt","toString","enc","Utf8","console","log","generateErrorPage","latexReplace","marked","loadMarkdownFilePage","loadHTMLFilePage","getActivePageFromPagesFn","getActivePageFromPageFn","Promise","resolve","reject","decryptedString","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","Model","toJS","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.90bc9f05.chunk.js","sourcesContent":["import React from 'react';\nimport { observer } from 'mobx-react';\nimport './sidebar.scss';\n\nclass Sidebar extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.model = props.model;\n    this.state = {\n      loginBox: false\n    };\n  }\n\n  renderLoginBox() {\n    if (this.model.loginInfo) {\n      return <div className=\"login-box\" onClick={() => this.model.logOut()}>\n        Sign out\n      </div>\n    }\n\n    if (this.state.loginBox) {\n      return <div className=\"login-box\">\n        {this.state.loginError ? <div className=\"login-error\">{this.state.loginError}</div> : null}\n        <input \n          autoFocus \n          type=\"password\"\n          onKeyDown={event => {\n            this.setState({loginError: null});\n              if (event.key === 'Enter') {\n                this.checkLoginPassword(event.target.value);\n              } else if (event.key === 'Escape') {\n                this.setState({loginBox: false});\n              }\n            }\n          }\n        />\n      </div>\n    }\n\n    return <div className=\"login-box\" onClick={() => this.setState({loginBox: true})}>\n      Sign in\n    </div>;\n  }\n\n  checkLoginPassword(password) {\n    this.model.logIn(password).catch(err => {\n      this.setState({loginError: err});\n    })\n  }\n\n  renderMenuItem(page) {\n    const path = window.location.hash.slice(1);\n\n    if (page.children) {\n      return <div>\n        <div className=\"menu-parent-item\">{page.name}</div>\n        <div className=\"menu-children\">\n          {page.children.map(p => this.renderMenuItem(p))}\n        </div>\n      </div>\n    } else {\n      if (!this.model.loginInfo && page.protected) {\n        return null;\n      }\n      return <div \n        key={page.url}\n        className={'menu-item' + (page.active ? ' active' : '')}\n        onClick={() => this.goTo(page)}\n        >\n          {page.name}\n      </div>; \n    }\n  }\n  \n  render() {\n    return (\n      <div id=\"sidebar\">\n        <h1 onClick={() => window.MathJax.typeset() }>EpiPolicy</h1>\n        <div className=\"menu\">\n          {this.model.pages.map(p => this.renderMenuItem(p))}\n        </div>\n        {this.renderLoginBox()}\n      </div>\n    );\n  }\n\n  goTo(page) {\n     document.title = page.name;\n     window.history.pushState({url: '#' + page.url}, page.name, '#' + page.url);\n     this.model.checkPagesActivation();\n  }\n\n\n}\n\nexport default observer(Sidebar);\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport './pagedisplay.scss';\nimport axios from 'axios';\n\nclass PageDisplay extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.model = props.model;\n  }\n\n  render() {\n    if (!this.model.activePage) {\n      return null;\n    }\n\n    return (\n      <div id=\"page-display\">\n        <h2>{this.model.activePage.name}</h2>\n        <div\n          id=\"page-content\"\n          dangerouslySetInnerHTML={{__html: this.model.activePageContent}}>\n        </div>\n      </div>\n    );\n    \n  }\n\n  componendDidMount() {\n    setTimeout(() => { window.MathJax.typeset(); }, 100);\n  }\n\n  componentDidUpdate() {\n    setTimeout(() => { window.MathJax.typeset(); }, 100);\n  }\n\n}\n\nexport default observer(PageDisplay);\n","import React from 'react';\nimport {observer} from 'mobx-react';\nimport './app.scss';\nimport Sidebar from './components/sidebar';\nimport PageDisplay from './components/pagedisplay';\n\nclass App extends React.Component {\n\n  render() {\n    return <div id=\"app\">\n      <div className=\"container-fluid no-gutters\">\n        <div className=\"row\">\n          <div id=\"sidebar-container\" className=\"col-2\">\n            <Sidebar model={this.props.model} />\n          </div>\n          <div id=\"main-panel-container\" className=\"col-10\">\n            <PageDisplay model={this.props.model} />\n          </div>\n        </div>\n      </div>\n    </div>;\n  }\n}\n\nexport default observer(App);\n","import { makeObservable, observable, computed, action } from 'mobx';\nimport pages_config from \"../pages.json\";\nimport axios from 'axios';\nimport marked from 'marked';\nimport CryptoJS from 'crypto-js';\n\nlet PASSWORD_CONTROL_STRING = 'salimmo sù, el primo e io secondo,\\ntanto ch’i’ vidi de le cose belle\\nche porta ’l ciel, per un pertugio tondo.\\nE quindi uscimmo a riveder le stelle.';\n\nclass Model {\n  pages = pages_config;\n  activePageContent = null;\n  loginInfo = null;\n\n  checkPagesActivation() {\n    const path = window.location.hash.slice(1);\n    let checkPagesFn = pages => {\n      for (let page of pages) {  \n        checkFn(page);\n      }\n    }\n    let checkFn = page => {\n      if (page.children) {\n        checkPagesFn(page.children);\n      }\n      page.active = path === page.url;\n    }\n    checkPagesFn(this.pages);\n    this.loadActivePage();\n  }\n\n  latexReplace(text) {\n    text = text.replace(/<latex>(.*?)<\\/latex>/g, \n      (match, p1) => '<div class=\"latex\">$' + p1 + '$</div>');\n    text = text.replace(/<latex-line>(.*?)<\\/latex-line>/g, \n      (match, p1) => '<div class=\"latex latex-line>$$' + p1 + '$$</div>');\n    text = text.replace(/<latex-line-left>(.*?)<\\/latex-line-left>/g, \n      (match, p1) => '<div class=\"latex latex-line latex-line-left\">$$' + p1 + '$$</div>');\n    return text;\n  }\n\n  generateErrorPage(errMsg) {\n    return '<div className=\"error\">' + errMsg +'</div>';\n  } \n\n  loadMarkdownFilePage() {\n    let urlRoot = this.activePage.protected ? 'private-pages/' : 'pages/';\n    axios.get(urlRoot + this.activePage['markdown-file'])\n      .then(response => {\n        let data = response.data;\n        if (this.activePage.protected) {\n          if (this.loginInfo) {\n            try {\n              let decrypted = CryptoJS.AES.decrypt(response.data, this.loginInfo.password);\n              data = decrypted.toString(CryptoJS.enc.Utf8);\n              console.log(data)\n            } catch (err) {\n              this.activePageContent = this.generateErrorPage(err);\n            }\n          } else {\n            this.activePageContent = this.generateErrorPage('Login needed in order to decrypt this file');\n          }\n        }\n        this.activePageContent = this.latexReplace(marked(data));\n      })\n      .catch(err => {\n        this.activePageContent = this.generateErrorPage(err);\n      });\n  }\n\n  loadHTMLFilePage() {\n    axios.get('html-pages/' + this.activePage['html-file'])\n      .then(response => {\n        this.activePageContent = response.data;\n      })\n      .catch(err => {\n        this.activePageContent = err;\n      });\n  }\n\n  loadActivePage() {\n    console.log('loadActivePage', this.activePage)\n    if (!this.activePage) {\n      return;\n    } else if (this.activePage['markdown-file']) {\n      this.loadMarkdownFilePage();\n    } else if (this.activePage['html-file']) {\n      this.loadHTMLFilePage();\n    }\n  }\n\n  get activePage() {\n    let getActivePageFromPagesFn = pages => {\n      for (let page of pages) {\n        let activePage = getActivePageFromPageFn(page);\n        if (activePage) return activePage;\n      }\n    }\n    let getActivePageFromPageFn = page => {\n      console.log('checking... ', page.name)\n      if (page.children) {\n        return getActivePageFromPagesFn(page.children);\n      }\n      if (page.active) return page;\n    }\n\n    let activePage = getActivePageFromPagesFn(this.pages);\n    console.log('activePage', activePage)\n    return activePage;\n  }\n\n  logIn(password) {\n    return new Promise((resolve, reject) => {\n      axios.get('private-pages/main.pmd')\n      .then(response => {\n        try {\n          let decrypted = CryptoJS.AES.decrypt(response.data, password);\n          let decryptedString = decrypted.toString(CryptoJS.enc.Utf8);\n          console.log('login check. decrypted:\\n' + decryptedString);\n          if (PASSWORD_CONTROL_STRING === decryptedString) {\n            this.loginInfo = {\n              password: password,\n            }\n          } else {\n            this.loginInfo = null;\n          }\n          resolve();\n        } catch (err) {\n          reject('Login failed');\n        }\n      });\n    });\n  }\n\n  logOut() {\n    this.loginInfo = null;\n  }\n\n  constructor() {\n    makeObservable(this, {\n      pages: observable,\n      checkPagesActivation: action,\n      loginInfo: observable,\n      logIn: action,\n      logOut: action,\n      activePageContent: observable,\n      activePage: computed\n    });\n\n    this.checkPagesActivation();\n    window.onpopstate = e => {\n      this.checkPagesActivation();\n    };\n  }\n\n}\n\nexport default new Model();\n\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './view/app';\nimport Model from './model';\nimport reportWebVitals from './reportWebVitals';\nimport {toJS} from 'mobx';\n\ndocument.model = Model;\ndocument.toJS = toJS;\n\nReactDOM.render(\n  <React.StrictMode>\n    <App model={Model}/>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}